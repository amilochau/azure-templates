{
  "properties": {
    "displayName": "MIL - Security initiative",
    "policyType": "Custom",
    "description": "Some rules to check if our resources respect common security practices",
    "metadata": {
      "category": "Security",
      "version": "1.0.0"
    },
    "parameters": {},
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "Function apps should only be accessible over HTTPS_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should only be accessible over HTTPS_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "API Management calls to API backends should not bypass certificate thumbprint or name validation_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "API Management calls to API backends should be authenticated_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "API Management APIs should use encrypted protocols only_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "API Management Named Values secrets should be stored in Azure KeyVault_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Storage accounts should prevent shared key access_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Storage accounts should prevent cross tenant object replication_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92a89a79-6c52-4a7e-a03f-61306fc49312",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure Key Vault should have firewall enabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure Cosmos DB key based metadata write access should be disabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Cosmos DB database accounts should have local authentication methods disabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure Cosmos DB accounts should have firewall rules_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
        "parameters": {
          "effect": {
            "value": "Audit"
          }
        },
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure Service Bus namespaces should have local authentication methods disabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cfb11c26-f069-4c14-8e36-56c394dae5af",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Application Insights components should block non-Azure Active Directory based ingestion._1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/199d5677-e4d9-4264-9465-efe1839c06bd",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should not have CORS configured to allow every resource to access your apps_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should use managed identity_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should have remote debugging turned off_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should require FTPS only_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should use latest 'HTTP Version'_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e2c1c086-2d84-4019-bff3-c44ccd95113c",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Function apps should use the latest TLS version_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should use managed identity_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should require FTPS only_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should not have CORS configured to allow every resource to access your apps_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service app slots should have local authentication methods disabled for SCM site deployments_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/847ef871-e2fe-4e6e-907e-4adbf71de5cf",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should have local authentication methods disabled for FTP deployments_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/871b205b-57cf-4e1e-a234-492616998bf7",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should use latest 'HTTP Version'_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c122334-9d20-4eb8-89ea-ac9a705b74ae",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should have local authentication methods disabled for SCM site deployments_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aede300b-d67f-480a-ae26-4b3dfb1a1fdc",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should have remote debugging turned off_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service app slots should have local authentication methods disabled for FTP deployments_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ec71c0bc-6a45-4b1f-9587-80dc83e6898c",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "App Service apps should use the latest TLS version_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure SQL Database should be running TLS version 1.2 or newer_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "Azure SQL Database should have Azure Active Directory Only Authentication enabled_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
        "parameters": {},
        "groupNames": []
      },
      {
        "policyDefinitionReferenceId": "SQL databases should have vulnerability findings resolved_1",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
        "parameters": {},
        "groupNames": []
      }
    ],
    "policyDefinitionGroups": []
  }
}